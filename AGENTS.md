# Repository Guidelines

## Project Structure & Module Organization
Roam Copilot is a Roam Research extension built with React + TypeScript. Application source sits in `src/`, with UI in `src/components`, hooks in `src/hooks`, AI/data contracts in `src/services` and `src/types.ts`, and shared helpers under `src/utils`. `commands.ts` and `settings.ts` register Roam commands and panels, while `styles.css` contains extension-wide styling. Built assets land in `dist/` (shipped to Roam Depot); marketing screenshots live in `assets/`. Automation scripts—including the Ollama CORS helpers—are under `scripts/`.

## Build, Test, and Development Commands
Run `npm install` once, then use:
```
npm run dev            # webpack dev build with watch + source maps
npm run build          # optimized production bundle
./build.sh             # install deps and run roamjs-scripts build --depot
```
`dist/` is regenerated by these commands; avoid editing it manually.

## Coding Style & Naming Conventions
TypeScript is compiled with strict settings (`tsconfig.json`). Follow existing patterns: 2-space indentation, double quotes, trailing semicolons, and `PascalCase` React components inside `src/components`. Hooks/components use descriptive names (`CopilotSidebar`, `useModelConfig`), utilities use camelCase verbs, and CSS classes live next to feature code. Prefer functional React components and Blueprint/Tiptap primitives already in use. Linting relies on TypeScript errors and webpack; run a build before opening PRs.

## Testing Guidelines
There is no formal unit-test suite yet; validate changes through `npm run dev` inside Roam and exercise core flows (sidebar load, provider switching, template execution). Use `scripts/test_ollama_cors.sh` to confirm local Ollama setups when touching CORS logic. When adding non-trivial logic, include lightweight regression scripts or document manual test steps in the PR.

## Commit & Pull Request Guidelines
Git history favors short, imperative titles (`fix token limit value`, `refactor AIService`). Keep commits focused and mention impacted modules. Pull requests should describe motivation, outline testing evidence (commands run or Roam steps), and link any related issues. UI-facing changes benefit from before/after screenshots or screen recordings so maintainers can verify without reproducing the entire scenario.

## Configuration & Security Tips
Never commit API keys or local Roam graphs. `settings.ts` reads provider credentials from the Roam settings panel—reference keys by name rather than hard-coding secrets. When documenting new providers, add instructions in `README.md` and keep companion scripts in `scripts/` so they can be audited easily.
